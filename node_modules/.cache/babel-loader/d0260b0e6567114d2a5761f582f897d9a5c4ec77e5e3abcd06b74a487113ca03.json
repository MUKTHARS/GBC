{"ast":null,"code":"const CryptoJS = require('crypto-js');\nconst ENCRYPTION_KEY = process.env.REACT_APP_ENCRYPTION_KEY || 'fallback-secure-key-2024-construction-pro-max-security';\nexport const encryptUrl = url => {\n  if (!ENCRYPTION_KEY) {\n    console.warn('Encryption key not found, using fallback');\n    return btoa(url);\n  }\n  try {\n    // Create a longer payload with more random data\n    const timestamp = Date.now();\n    const randomString1 = Math.random().toString(36).substring(2, 15);\n    const randomString2 = Math.random().toString(36).substring(2, 15);\n    const randomString3 = Math.random().toString(36).substring(2, 15);\n    const payload = JSON.stringify({\n      target: url,\n      timestamp: timestamp,\n      salt: process.env.REACT_APP_ENCRYPTION_SALT || 'construction-pro-salt-2024',\n      random1: randomString1,\n      random2: randomString2,\n      random3: randomString3,\n      version: '2.0',\n      checksum: CryptoJS.MD5(url + timestamp).toString()\n    });\n\n    // Triple layer encryption for maximum security\n    const layer1 = CryptoJS.AES.encrypt(payload, ENCRYPTION_KEY + '1').toString();\n    const layer2 = CryptoJS.DES.encrypt(layer1, ENCRYPTION_KEY + '2').toString();\n    const layer3 = CryptoJS.TripleDES.encrypt(layer2, ENCRYPTION_KEY + '3').toString();\n\n    // Base64 encode and add prefix for longer URL\n    const base64Encoded = btoa(layer3);\n\n    // Make it even longer by adding more random data\n    return base64Encoded + '&' + Math.random().toString(36).substring(2, 25);\n  } catch (error) {\n    console.error('Encryption error:', error);\n    return btoa(url);\n  }\n};\nexport const decryptUrl = encryptedUrl => {\n  if (!ENCRYPTION_KEY) {\n    console.warn('Encryption key not found, using fallback');\n    return atob(encryptedUrl);\n  }\n  try {\n    // Remove the additional random data\n    const base64Part = encryptedUrl.split('&')[0];\n    const decoded = atob(base64Part);\n\n    // Triple layer decryption\n    const layer3 = CryptoJS.TripleDES.decrypt(decoded, ENCRYPTION_KEY + '3');\n    const layer2 = layer3.toString(CryptoJS.enc.Utf8);\n    const layer1 = CryptoJS.DES.decrypt(layer2, ENCRYPTION_KEY + '2');\n    const payloadStr = layer1.toString(CryptoJS.enc.Utf8);\n    const decrypted = CryptoJS.AES.decrypt(payloadStr, ENCRYPTION_KEY + '1');\n    const finalResult = decrypted.toString(CryptoJS.enc.Utf8);\n    const parsed = JSON.parse(finalResult);\n    return parsed.target;\n  } catch (error) {\n    console.error('Decryption error:', error);\n    return atob(encryptedUrl);\n  }\n};","map":{"version":3,"names":["CryptoJS","require","ENCRYPTION_KEY","process","env","REACT_APP_ENCRYPTION_KEY","encryptUrl","url","console","warn","btoa","timestamp","Date","now","randomString1","Math","random","toString","substring","randomString2","randomString3","payload","JSON","stringify","target","salt","REACT_APP_ENCRYPTION_SALT","random1","random2","random3","version","checksum","MD5","layer1","AES","encrypt","layer2","DES","layer3","TripleDES","base64Encoded","error","decryptUrl","encryptedUrl","atob","base64Part","split","decoded","decrypt","enc","Utf8","payloadStr","decrypted","finalResult","parsed","parse"],"sources":["C:/src/GBC-main/src/utils/encryption.js"],"sourcesContent":["const CryptoJS = require('crypto-js');\n\nconst ENCRYPTION_KEY = process.env.REACT_APP_ENCRYPTION_KEY || 'fallback-secure-key-2024-construction-pro-max-security';\n\nexport const encryptUrl = (url) => {\n  if (!ENCRYPTION_KEY) {\n    console.warn('Encryption key not found, using fallback');\n    return btoa(url);\n  }\n  \n  try {\n    // Create a longer payload with more random data\n    const timestamp = Date.now();\n    const randomString1 = Math.random().toString(36).substring(2, 15);\n    const randomString2 = Math.random().toString(36).substring(2, 15);\n    const randomString3 = Math.random().toString(36).substring(2, 15);\n    \n    const payload = JSON.stringify({\n      target: url,\n      timestamp: timestamp,\n      salt: process.env.REACT_APP_ENCRYPTION_SALT || 'construction-pro-salt-2024',\n      random1: randomString1,\n      random2: randomString2,\n      random3: randomString3,\n      version: '2.0',\n      checksum: CryptoJS.MD5(url + timestamp).toString()\n    });\n\n    // Triple layer encryption for maximum security\n    const layer1 = CryptoJS.AES.encrypt(payload, ENCRYPTION_KEY + '1').toString();\n    const layer2 = CryptoJS.DES.encrypt(layer1, ENCRYPTION_KEY + '2').toString();\n    const layer3 = CryptoJS.TripleDES.encrypt(layer2, ENCRYPTION_KEY + '3').toString();\n    \n    // Base64 encode and add prefix for longer URL\n    const base64Encoded = btoa(layer3);\n    \n    // Make it even longer by adding more random data\n    return base64Encoded + '&' + Math.random().toString(36).substring(2, 25);\n    \n  } catch (error) {\n    console.error('Encryption error:', error);\n    return btoa(url);\n  }\n};\n\nexport const decryptUrl = (encryptedUrl) => {\n  if (!ENCRYPTION_KEY) {\n    console.warn('Encryption key not found, using fallback');\n    return atob(encryptedUrl);\n  }\n  \n  try {\n    // Remove the additional random data\n    const base64Part = encryptedUrl.split('&')[0];\n    const decoded = atob(base64Part);\n    \n    // Triple layer decryption\n    const layer3 = CryptoJS.TripleDES.decrypt(decoded, ENCRYPTION_KEY + '3');\n    const layer2 = layer3.toString(CryptoJS.enc.Utf8);\n    const layer1 = CryptoJS.DES.decrypt(layer2, ENCRYPTION_KEY + '2');\n    const payloadStr = layer1.toString(CryptoJS.enc.Utf8);\n    const decrypted = CryptoJS.AES.decrypt(payloadStr, ENCRYPTION_KEY + '1');\n    const finalResult = decrypted.toString(CryptoJS.enc.Utf8);\n    \n    const parsed = JSON.parse(finalResult);\n    return parsed.target;\n    \n  } catch (error) {\n    console.error('Decryption error:', error);\n    return atob(encryptedUrl);\n  }\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}